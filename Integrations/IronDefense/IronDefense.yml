category: Network Security
commonfields:
  id: IronDefense
  version: -1
configuration:
- display: IronAPI Host/IP
  name: ironAPIHost
  required: true
  type: 0
- defaultvalue: '6942'
  display: IronAPI Port
  name: ironAPIPort
  required: true
  type: 0
- display: Username
  name: credentials
  required: true
  type: 9
- defaultvalue: '60'
  display: Request Timeout (Sec)
  name: requestTimeout
  required: false
  type: 0
- display: Dome Notification Types to Exclude.
  name: domeCategories
  options:
  - Participant Added
  - Comment Added
  - Community Severity Changed
  - Community Severity Mismatched
  - Enterprise Severity Mismatched
  - Severity Suspicious
  - Severity Malicious
  - Joined High Risk
  - High Cognitive System Score
  required: false
  type: 16
- display: Disable all Dome Notification Ingestion.
  name: disableDomeNotifications
  required: false
  type: 8
- display: Alert Notification Categories to Exclude.
  name: alertCategories
  options:
  - C2
  - Action
  - Access
  - Recon
  - Other
  required: false
  type: 16
- display: Alert Notification SubCategories to Exclude (enter in CSV format).
  name: alertSubCategories
  options:
  - ''
  required: false
  type: 12
- defaultvalue: '0'
  display: Lower Bound of Severity for Alert Notification.
  name: alertSeverityLower
  required: false
  type: 0
- defaultvalue: '1000'
  display: Upper Bound of Severity for Alert Notification.
  name: alertSeverityUpper
  required: false
  type: 0
- display: Disable all Alert Notification Ingestion.
  name: disableAlertNotifications
  required: false
  type: 8
- display: Event Notification Categories to Exclude.
  name: eventCategories
  options:
  - C2
  - Action
  - Access
  - Recon
  - Other
  required: false
  type: 16
- display: Event Notification SubCategories to Exclude (enter in CSV format).
  name: eventSubCategories
  options:
  - ''
  required: false
  type: 12
- defaultvalue: '0'
  display: Lower Bound of Severity for Event Notification.
  name: eventSeverityLower
  required: false
  type: 0
- defaultvalue: '1000'
  display: Upper Bound of Severity for Event Notification.
  name: eventSeverityUpper
  required: false
  type: 0
- display: Disable all Event Notification Ingestion.
  name: disableEventNotifications
  required: false
  type: 8
- defaultvalue: '500'
  display: Dome Notification limit per request.
  name: domeLimit
  required: false
  type: 0
- defaultvalue: '500'
  display: Alert Notification limit per request.
  name: alertLimit
  required: false
  type: 0
- defaultvalue: '500'
  display: Event Notification limit per request.
  name: eventLimit
  required: false
  type: 0
description: The IronDefense Integration for Demisto allows users to interact with
  IronDefense alerts within Demisto. The Integration provides the ability to rate
  alerts, update alert statuses, add comments to alerts, and to report observed bad
  activity.
display: IronDefense
name: IronDefense
script:
  commands:
  - arguments:
    - default: false
      description: The ID of the IronDefense alert
      isArray: false
      name: alert_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The severity rating of this alert
      isArray: false
      name: severity
      predefined:
      - Undecided
      - Benign
      - Suspicious
      - Malicious
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Was this rating expected? Use "Unknown" if the rating is undecided
      isArray: false
      name: expectation
      predefined:
      - Unknown
      - Expected
      - Unexpected
      required: true
      secret: false
    - default: false
      description: Explain the rating of this alert
      isArray: false
      name: comments
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Shares the provided comment with IronDome
      isArray: false
      name: share_comment_with_irondome
      predefined:
      - 'True'
      - 'False'
      required: true
      secret: false
    deprecated: false
    description: Rates an IronDefense alert.
    execution: false
    name: irondefense-rate-alert
  - arguments:
    - default: false
      description: The ID of the IronDefense alert
      isArray: false
      name: alert_id
      required: true
      secret: false
    - default: false
      description: Text of comment
      isArray: false
      name: comment
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Shares the provided comment with IronDome
      isArray: false
      name: share_comment_with_irondome
      predefined:
      - 'True'
      - 'False'
      required: true
      secret: false
    deprecated: false
    description: Adds a comment to an IronDefense alert
    execution: false
    name: irondefense-comment-alert
  - arguments:
    - default: false
      description: The ID of the IronDefense alert
      isArray: false
      name: alert_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The alert status to set
      isArray: false
      name: status
      predefined:
      - Awaiting Review
      - Under Review
      - Closed
      required: true
      secret: false
    - default: false
      description: Explain the status of this alert
      isArray: false
      name: comments
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Shares the provided comment with IronDome
      isArray: false
      name: share_comment_with_irondome
      predefined:
      - 'True'
      - 'False'
      required: true
      secret: false
    deprecated: false
    description: Sets the status of an IronDefense alert
    execution: false
    name: irondefense-set-alert-status
  - arguments:
    - default: false
      description: The name of the Threat Intelligence Rule (TIR) to be created.
      isArray: false
      name: name
      required: true
      secret: false
    - default: false
      description: A description of the observed bad endpoint.
      isArray: false
      name: description
      required: true
      secret: false
    - default: false
      description: The IP address of the observed bad endpoint.
      isArray: false
      name: ip
      required: false
      secret: false
    - default: false
      description: The domain name of the observed bad endpoint.
      isArray: false
      name: domain
      required: false
      secret: false
    - default: false
      description: The start time of the observed bad activity in RFC 3339 format.
      isArray: false
      name: activity_start_time
      required: true
      secret: false
    - default: false
      description: The end time of the observed bad activity in RFC 3339 format.
      isArray: false
      name: activity_end_time
      required: true
      secret: false
    deprecated: false
    description: Submits an observed bad endpoint to IronDefense to create Threat
      Intelligence Rules (TIR).
    execution: false
    name: irondefense-report-observed-bad-activity
  - arguments:
    - default: false
      description: The ID of the IronDefense event
      isArray: false
      name: event_id
      required: true
      secret: false
    deprecated: false
    description: Retrieves an IronDefense event
    execution: false
    name: irondefense-get-event
    outputs:
    - contextPath: event
      description: The IronDefense event
      type: String
  - arguments:
    - default: false
      description: The list of Alert IDs to filter by.
      isArray: false
      name: alert_id
      required: false
      secret: false
    - default: false
      description: The list of Alert categories to filter by.
      isArray: false
      name: category
      required: false
      secret: false
    - default: false
      description: The list of Alert sub categories to filter by.
      isArray: false
      name: sub_category
      required: false
      secret: false
    - default: false
      description: The list of Alert status to filter by.
      isArray: false
      name: status
      required: false
      secret: false
    - default: false
      description: The list of Alert analyst severity to filter by.
      isArray: false
      name: analyst_severity
      required: false
      secret: false
    - default: false
      description: The list of Alert analyst expectation to filter by.
      isArray: false
      name: analyst_expectation
      required: false
      secret: false
    - default: false
      description: The minimum Alert severity to filter by.
      isArray: false
      name: min_severity
      required: false
      secret: false
    - default: false
      description: The maximum Alert severity to filter by.
      isArray: false
      name: max_severity
      required: false
      secret: false
    - default: false
      description: The minimum Alert created date to filter by.
      isArray: false
      name: min_created
      required: false
      secret: false
    - default: false
      description: The maximum Alert created date to filter by.
      isArray: false
      name: max_created
      required: false
      secret: false
    - default: false
      description: The minimum Alert updated date to filter by.
      isArray: false
      name: min_updated
      required: false
      secret: false
    - default: false
      description: The maximum Alert updated date to filter by.
      isArray: false
      name: max_updated
      required: false
      secret: false
    - default: false
      description: The minimum Alert first event created date to filter by.
      isArray: false
      name: min_first_event_created
      required: false
      secret: false
    - default: false
      description: The maximum Alert first event created date to filter by.
      isArray: false
      name: max_first_event_created
      required: false
      secret: false
    - default: false
      description: The minimum Alert last event created date to filter by.
      isArray: false
      name: min_last_event_created
      required: false
      secret: false
    - default: false
      description: The maximum Alert last event created date to filter by.
      isArray: false
      name: max_last_event_created
      required: false
      secret: false
    - default: false
      description: The minimum Alert first event start date to filter by.
      isArray: false
      name: min_first_event_start_time
      required: false
      secret: false
    - default: false
      description: The maximum Alert first event start date to filter by.
      isArray: false
      name: max_first_event_start_time
      required: false
      secret: false
    - default: false
      description: The minimum Alert last event end date to filter by.
      isArray: false
      name: min_last_event_end_time
      required: false
      secret: false
    - default: false
      description: The maximum Alert last event end date to filter by.
      isArray: false
      name: max_last_event_end_time
      required: false
      secret: false
    - default: false
      description: The list of Alert analytic versions to filter by.
      isArray: false
      name: analytic_version
      required: false
      secret: false
    - default: false
      description: The limit on the number of Alerts to be returned.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: The number of results to skip - used for paging the results
      isArray: false
      name: offset
      required: false
      secret: false
    - default: false
      description: The list of Alert fields to sort by.
      isArray: false
      name: sort
      required: false
      secret: false
    deprecated: false
    description: Pulls Alerts from IronDefense.
    execution: false
    name: irondefense-get-alerts
    outputs:
    - contextPath: alerts
      description: Returned alerts
      type: string
    - contextPath: constraint
      description: constraints
      type: string
  - arguments:
    - default: false
      description: The ID of the IronDefense alert
      isArray: false
      name: alert_id
      required: true
      secret: false
    deprecated: false
    description: Retrieves IronDome information for an IronDefense alert
    execution: false
    name: irondefense-get-alert-irondome-information
    outputs:
    - contextPath: alert_irondome_information
      description: The IronDome information for the Irondefense alert
      type: String
  - arguments:
    - default: false
      description: The ID of the IronDefense alert to retrieve events for
      isArray: false
      name: alert_id
      required: true
      secret: false
    - default: false
      description: The limit on the number of Events to be returned.
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: The number of results to skip - used for paging the results
      isArray: false
      name: offset
      required: false
      secret: false
    deprecated: false
    description: Retrieves IronDefense Events for a given Alert ID
    execution: false
    name: irondefense-get-events
    outputs:
    - contextPath: events
      description: The IronDefense events
      type: String
  dockerimage: demisto/python3:3.7.4.1900
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  type: python
tests:
- No tests
